<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚²ãƒ¼ãƒ ã‚®ãƒ£ã‚¶ãƒ¼æœ€é©åŒ–è¨ˆç®—ãƒ„ãƒ¼ãƒ«</title>
    
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            max-width: 500px; /* ã‚¹ãƒãƒ›ã§è¦‹ã‚„ã™ã„æœ€å¤§å¹… */
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f4f9;
            color: #333;
        }

        h1 {
            text-align: center;
            color: #1a73e8;
            font-size: 1.8rem;
            margin-bottom: 30px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            font-size: 1rem;
        }

        input[type="number"] {
            width: 100%;
            padding: 12px;
            font-size: 1.2rem;
            border: 2px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
        }

        button {
            width: 100%;
            padding: 15px;
            font-size: 1.3rem;
            font-weight: bold;
            color: white;
            background-color: #4285f4;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 10px;
            transition: background-color 0.2s;
        }

        button:hover {
            background-color: #357ae8;
        }

        .result-box {
            margin-top: 30px;
            padding: 15px;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            white-space: pre-wrap; /* æ”¹è¡Œã‚’åæ˜ ã•ã›ã‚‹ */
            min-height: 100px;
            font-size: 1.1rem;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <h1>ã‚¢ã‚¤ãƒ†ãƒ ç›®æ¨™é”æˆè¨ˆç®—</h1>
    <div class="input-group">
        <label for="currentItems">ç¾åœ¨ã®ã‚¢ã‚¤ãƒ†ãƒ å€‹æ•° (ç›®æ¨™ 2000)</label>
        <input type="number" id="currentItems" value="1000" placeholder="ç¾åœ¨ã®å€‹æ•°">
    </div>
    <div class="input-group">
        <label for="availableStamina">ä½¿ãˆã‚‹ã‚¹ã‚¿ãƒŸãƒŠæ•° (ã‚³ã‚¹ãƒˆ 21)</label>
        <input type="number" id="availableStamina" value="420" placeholder="ã‚¹ã‚¿ãƒŸãƒŠæ•°">
    </div>

    <button onclick="calculateOptimal()">è¨ˆç®—å®Ÿè¡Œ</button>

    <div id="result" class="result-box">
        </div>

    <script>
        /**
         * ã‚®ãƒ£ã‚¶ãƒ¼ã®æœ€é©åŒ–è¨ˆç®—ã‚’å®Ÿè¡Œã—ã€çµæœã‚’ç”»é¢ã«è¡¨ç¤ºã™ã‚‹
         * ãƒ­ã‚¸ãƒƒã‚¯: é¶´äº€ç®—ã®å¿œç”¨ã§ã€2000å€‹é”æˆã«å¿…è¦ãªAã‚®ãƒ£ã‚¶ãƒ¼ã®æœ€å°å›æ•°ã‚’æ±‚ã‚ã‚‹ã€‚
         */
        function calculateOptimal() {
            // å…¥åŠ›å€¤ã®å–å¾—ã¨æ•°å€¤ã¸ã®å¤‰æ›
            const currentItemsInput = document.getElementById('currentItems').value;
            const availableStaminaInput = document.getElementById('availableStamina').value;

            const currentItems = parseInt(currentItemsInput);
            const availableStamina = parseInt(availableStaminaInput);

            // å…¥åŠ›ãƒã‚§ãƒƒã‚¯
            if (isNaN(currentItems) || isNaN(availableStamina) || currentItems < 0 || availableStamina < 0) {
                document.getElementById('result').innerHTML = '<span style="color: red; font-weight: bold;">âš ï¸ ã‚¢ã‚¤ãƒ†ãƒ æ•°ã¨ã‚¹ã‚¿ãƒŸãƒŠæ•°ã«æ­£ã—ã„æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</span>';
                return;
            }

            const goal = 2000;
            const neededItems = goal - currentItems;

            let resultHtml = '';

            // æ—¢ã«ç›®æ¨™é”æˆã—ã¦ã„ã‚‹å ´åˆ
            if (neededItems <= 0) {
                resultHtml = `
                <span style="color: green; font-weight: bold;">ğŸ‰ ç›®æ¨™ã‚¢ã‚¤ãƒ†ãƒ æ•°(${goal}å€‹)ã¯æ—¢ã«é”æˆã—ã¦ã„ã¾ã™ï¼</span>
                `;
            } else {
                // --- é¶´äº€ç®—ã®åˆ¶ç´„è¨ˆç®— ---
                const STAMINA_COST = 21;
                const DROP_A = 10;
                const DROP_B = 3;

                // ä½¿ãˆã‚‹ã‚¹ã‚¿ãƒŸãƒŠå†…ã§å¯èƒ½ãªæœ€å¤§ç·å›æ•° (T)
                const totalMaxCount = Math.floor(availableStamina / STAMINA_COST);

                // Bã‚®ãƒ£ã‚¶ãƒ¼ã‚’totalMaxCountå›è¡Œã£ãŸã¨ä»®å®šã—ãŸå ´åˆã®ã‚¢ã‚¤ãƒ†ãƒ ä¸è¶³åˆ†
                const remainingAfterB = neededItems - (DROP_B * totalMaxCount);

                // 1. é”æˆä¸å¯èƒ½ãªå ´åˆ (ã™ã¹ã¦Aã«ã—ã¦ã‚‚ç›®æ¨™ã«å±Šã‹ãªã„å ´åˆ)
                if (DROP_A * totalMaxCount < neededItems) {
                    const shortage = neededItems - (DROP_A * totalMaxCount);
                    resultHtml = `
                    <span style="color: red; font-weight: bold;">âŒ ç›®æ¨™é”æˆã¯ä¸å¯èƒ½</span>
                    ã‚¹ã‚¿ãƒŸãƒŠå†…(${availableStamina})ã§å¯èƒ½ãªæœ€å¤§åŠ¹ç‡ã®
                    ã‚®ãƒ£ã‚¶ãƒ¼(A)ã‚’å…¨ã¦è¡Œã£ã¦ã‚‚ã€ã‚ã¨ ${shortage}å€‹ä¸è¶³ã—ã¾ã™ã€‚
                    `;
                } 
                // 2. æœ€å°Aå›æ•°ã‚’è¨ˆç®—
                else if (remainingAfterB > 0) {
                    // Aã¨Bã®ãƒ‰ãƒ­ãƒƒãƒ—æ•°ã®å·® (10 - 3 = 7) ã§ä¸è¶³åˆ†ã‚’è£œã†
                    const dropDifference = DROP_A - DROP_B;
                    const minACount = Math.ceil(remainingAfterB / dropDifference);
                    const minBCount = totalMaxCount - minACount;
                    const totalItems = (minACount * DROP_A) + (minBCount * DROP_B);
                    
                    // minACountãŒè² ã«ãªã‚‹å ´åˆã¯ã€å®Ÿè³ªAã¯0å›ã§OKãªã®ã§ä¿®æ­£
                    const finalMinACount = Math.max(0, minACount);
                    const finalMinBCount = totalMaxCount - finalMinACount;

                    resultHtml = `
                    <span style="color: green; font-weight: bold;">âœ… ç›®æ¨™é”æˆå¯èƒ½ï¼ˆæœ€å°Aå›æ•°ï¼‰</span>

                    2000å€‹é”æˆã®ãŸã‚ã«ã€Aã‚®ãƒ£ã‚¶ãƒ¼ã¯æœ€ä½ **${finalMinACount}å›** å‚åŠ ãŒå¿…è¦ã§ã™ã€‚

                    <span style="font-size: 1.1rem; display: block; margin-top: 10px;">
                    ğŸ”¸ å†…è¨³ï¼ˆã‚¹ã‚¿ãƒŸãƒŠ ${availableStamina} ã®ç¯„å›²ã§æœ€ã‚‚åŠ¹ç‡çš„ï¼‰:
                    ãƒ»Aã‚®ãƒ£ã‚¶ãƒ¼ (ãƒ‰ãƒ­ãƒƒãƒ—10): ${finalMinACount}å›
                    ãƒ»Bã‚®ãƒ£ã‚¶ãƒ¼ (ãƒ‰ãƒ­ãƒƒãƒ—3): ${finalMinBCount}å›
                    ãƒ»åˆè¨ˆã‚¢ã‚¤ãƒ†ãƒ : ${totalItems}å€‹
                    ãƒ»åˆè¨ˆæ¶ˆè²»ã‚¹ã‚¿ãƒŸãƒŠ: ${totalMaxCount * STAMINA_COST}
                    </span>
                    `;
                }
                // 3. ã™ã¹ã¦Bã«ã—ã¦ã‚‚ç›®æ¨™ã‚’é”æˆã§ãã‚‹å ´åˆ (Aã¯ä¸è¦)
                else {
                    resultHtml = `
                    <span style="color: green; font-weight: bold;">âœ… ç›®æ¨™é”æˆå¯èƒ½ï¼ˆAã¯ä¸è¦ï¼‰</span>

                    ã‚¹ã‚¿ãƒŸãƒŠå†…ã§å¯èƒ½ãªæœ€å¤§ç·å›æ•° ${totalMaxCount}å› ã‚’ã™ã¹ã¦Bã‚®ãƒ£ã‚¶ãƒ¼ï¼ˆãƒ‰ãƒ­ãƒƒãƒ—3ï¼‰ã«å……ã¦ã¦ã‚‚ã€ç›®æ¨™ã‚’é”æˆã§ãã¾ã™ã€‚
                    Aã‚®ãƒ£ã‚¶ãƒ¼ã¯ **0å›** ã§OKã§ã™ã€‚
                    `;
                }
            }

            document.getElementById('result').innerHTML = resultHtml;
        }

        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã¨å…¥åŠ›å¤‰æ›´æ™‚ã«è¨ˆç®—ã‚’å®Ÿè¡Œã—ã¦åˆæœŸå€¤ã‚’è¡¨ç¤º
        document.addEventListener('DOMContentLoaded', calculateOptimal);
        document.getElementById('currentItems').addEventListener('input', calculateOptimal);
        document.getElementById('availableStamina').addEventListener('input', calculateOptimal);

    </script>
</body>
</html>
