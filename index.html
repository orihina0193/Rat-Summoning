<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¬å–šã‚¤ãƒ™</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f0f0f0;
      padding: 2em;
      margin: 0;
    }

    h1 {
      text-align: center;
      color: #333;
      font-size: 1.5em;
    }

    form {
      background: #fff;
      padding: 1em;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      max-width: 600px;
      margin: auto;
      width: 100%;
      box-sizing: border-box;
    }

    label {
      display: block;
      margin: 0.5em 0;
      font-size: 1em;
    }

    input {
      width: 100%;
      padding: 0.5em;
      margin-top: 0.2em;
      box-sizing: border-box;
      font-size: 1em;
    }

    button {
      margin-top: 1em;
      padding: 0.7em 1.5em;
      font-size: 1em;
      background-color: #0078d4;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      width: 100%;
    }

    button:hover {
      background-color: #005fa3;
    }

    pre {
      margin-top: 2em;
      background: #fff;
      padding: 1em;
      border-radius: 8px;
      white-space: pre-wrap;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
      max-width: 600px;
      margin: 2em auto 0;
      box-sizing: border-box;
      font-size: 0.95em;
    }

    @media (max-width: 480px) {
      body {
        padding: 1em;
      }

      h1 {
        font-size: 1.2em;
      }

      label, input, button, pre {
        font-size: 1em;
      }
    }
  </style>
</head>
<body>
  <h1>å‹æ•—è¨ˆç®—ãƒ„ãƒ¼ãƒ«</h1>
  <form>
    <label for="currentItems">ç¾åœ¨ã®ã‚¢ã‚¤ãƒ†ãƒ å€‹æ•° (ç›®æ¨™ 2000)</label>
    <input type="number" id="currentItems" placeholder="ç¾åœ¨ã®å€‹æ•°">

    <label for="availableStamina">ä½¿ãˆã‚‹ã‚¹ã‚¿ãƒŸãƒŠæ•° (ã‚³ã‚¹ãƒˆ 21)</label>
    <input type="number" id="availableStamina" placeholder="ã‚¹ã‚¿ãƒŸãƒŠæ•°">

    <button type="button" onclick="calculateOptimal()">è¨ˆç®—å®Ÿè¡Œ</button>
  </form>

  <pre id="result"></pre>

  <script>
    function calculateOptimal() {
      const currentItems = parseInt(document.getElementById('currentItems').value);
      const availableStamina = parseInt(document.getElementById('availableStamina').value);

      if (isNaN(currentItems) || isNaN(availableStamina) || currentItems < 0 || availableStamina < 0) {
        document.getElementById('result').textContent = 'âš ï¸ ã‚¢ã‚¤ãƒ†ãƒ æ•°ã¨ã‚¹ã‚¿ãƒŸãƒŠæ•°ã«æ­£ã—ã„æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
        return;
      }

      const goal = 2000;
      const neededItems = goal - currentItems;
      let resultText = '';

      if (neededItems <= 0) {
        resultText = `ğŸ‰ ç›®æ¨™ã‚¢ã‚¤ãƒ†ãƒ æ•°(${goal}å€‹)ã¯æ—¢ã«é”æˆã—ã¦ã„ã¾ã™ï¼`;
        document.getElementById('result').textContent = resultText;
        return;
      }

      const STAMINA_COST = 21;
      const DROP_A = 10;
      const DROP_B = 3;
      const DROP_DIFF = DROP_A - DROP_B;

      const totalMaxCount = Math.floor(availableStamina / STAMINA_COST);
      const maxItemsFromB = totalMaxCount * DROP_B;
      const itemsShortage = neededItems - maxItemsFromB;

      let finalMinACount;

      if (itemsShortage <= 0) {
        finalMinACount = 0;
      } else {
        finalMinACount = Math.ceil(itemsShortage / DROP_DIFF);
      }

      const finalMaxBCount = totalMaxCount - finalMinACount;
      const totalItemsAchieved = (finalMinACount * DROP_A) + (finalMaxBCount * DROP_B);

      if (finalMinACount < 0 || finalMinACount > totalMaxCount || totalItemsAchieved < neededItems) {
        const A_needed_for_2000_alone = Math.ceil(neededItems / DROP_A);
        const minStaminaCost_for_2000 = A_needed_for_2000_alone * STAMINA_COST;
        const shortage = minStaminaCost_for_2000 - availableStamina;

        resultText = `âŒ ã‚¹ã‚¿ãƒŸãƒŠä¸è¶³ã§ç›®æ¨™é”æˆä¸å¯\nç›®æ¨™é”æˆã«å¿…è¦ãªæœ€å°ã‚¹ã‚¿ãƒŸãƒŠã¯ ${minStaminaCost_for_2000} ã§ã™ã€‚\nã‚ã¨ ${shortage} ã‚¹ã‚¿ãƒŸãƒŠãŒå¿…è¦ã§ã™ã€‚`;
      } else {
        const minStaminaCost = totalMaxCount * STAMINA_COST;
        const remainingStamina = availableStamina - minStaminaCost;

        resultText = `âœ… ç›®æ¨™é”æˆå¯èƒ½ï¼ˆAã®æœ€å°å›æ•°ï¼‰\n\n2000å€‹é”æˆã®ãŸã‚ã«ã€Aã‚®ãƒ£ã‚¶ãƒ¼ã¯æœ€ä½ ${finalMinACount}å› å‚åŠ ãŒå¿…è¦ã§ã™ã€‚\n\nğŸ”¸ å†…è¨³ï¼ˆä½¿ãˆã‚‹ã‚¹ã‚¿ãƒŸãƒŠ ${availableStamina} ã®ç¯„å›²ã§æœ€ã‚‚AãŒå°‘ãªã„çµ„ã¿åˆã‚ã›ï¼‰:\nãƒ»Aã‚®ãƒ£ã‚¶ãƒ¼ (ãƒ‰ãƒ­ãƒƒãƒ—10): ${finalMinACount}å›\nãƒ»Bã‚®ãƒ£ã‚¶ãƒ¼ (ãƒ‰ãƒ­ãƒƒãƒ—3): ${finalMaxBCount}å›\nãƒ»åˆè¨ˆã‚¢ã‚¤ãƒ†ãƒ : ${totalItemsAchieved}å€‹\nãƒ»åˆè¨ˆæ¶ˆè²»ã‚¹ã‚¿ãƒŸãƒŠ: ${minStaminaCost} (æ®‹ã‚Šã‚¹ã‚¿ãƒŸãƒŠ: ${remainingStamina})`;
      }

      document.getElementById('result').textContent = resultText;
    }

    window.onload = calculateOptimal;
    document.getElementById('currentItems').addEventListener('input', calculateOptimal);
    document.getElementById('availableStamina').addEventListener('input', calculateOptimal);
  </script>
</body>
</html>
