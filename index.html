<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚®ãƒ£ã‚¶ãƒ¼æœ€é©åŒ–è¨ˆç®—ãƒ„ãƒ¼ãƒ«</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: #f0f0f0;
            padding: 1em;
            margin: 0;
        }

        h1 {
            text-align: center;
            color: #1a73e8;
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        .calculator-container {
            background: #fff;
            padding: 1.5em;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            max-width: 600px;
            margin: auto;
            width: 100%;
            box-sizing: border-box;
        }

        label {
            display: block;
            margin: 0.5em 0;
            font-size: 1em;
            font-weight: bold;
        }

        /* ğŸ’¡ å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã‚µã‚¤ã‚ºã‚’å›ºå®šã—ã€å¤§ããã€å®‰å®šã•ã›ã‚‹ */
        input[type="number"] {
            width: 100%;
            padding: 15px 12px;
            font-size: 1.4rem;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            line-height: 1; 
        }

        button {
            margin-top: 1.5em;
            padding: 0.8em 1.5em;
            font-size: 1.1em;
            background-color: #4285f4;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
        }

        button:hover {
            background-color: #357ae8;
        }

        /* ä¿®æ­£ç‚¹: çµæœãƒœãƒƒã‚¯ã‚¹ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å®‰å®šåŒ– */
        #result {
            margin-top: 2em;
            padding: 10px 0;
            white-space: pre-wrap;
            box-sizing: border-box;
            font-size: 1.1em;
            color: #333;
            line-height: 1.3; /* è¡Œé–“ã‚’è©°ã‚ã‚‹ */
            text-align: left; /* å·¦å¯„ã›è¨­å®šã‚’å¼·åˆ¶ */
        }
        
        .status-header {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 5px;
            padding-bottom: 5px;
            border-bottom: 2px solid #eee;
        }

        .min-count-line {
            display: block;
            margin: 5px 0;
            font-size: 1.1em;
            font-weight: normal;
        }

        .details-header {
            display: block;
            margin-top: 8px;
            font-weight: bold; 
            color: #ffa500;
            margin-bottom: 3px;
        }
        
        /* ãƒªã‚¹ãƒˆã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’å¾¹åº•çš„ã«ãƒªã‚»ãƒƒãƒˆ */
        #result ul {
            list-style: none;
            padding-left: 0 !important;
            margin: 3px 0 0 !important;
        }
        
        /* ãƒªã‚¹ãƒˆé …ç›®ã‚‚å·¦å¯„ã› */
        #result li {
            margin-bottom: 3px !important;
            padding-left: 0 !important;
        }
    </style>
</head>
<body>
    <div class="calculator-container">
        <h1>ã‚¢ã‚¤ãƒ†ãƒ ç›®æ¨™é”æˆè¨ˆç®—</h1>
        
        <label for="currentItems">ç¾åœ¨ã®ã‚¢ã‚¤ãƒ†ãƒ å€‹æ•° (ç›®æ¨™ 2000)</label>
        <input type="number" id="currentItems" value="1000" placeholder="ç¾åœ¨ã®å€‹æ•°">
    
        <label for="availableStamina">ä½¿ãˆã‚‹ã‚¹ã‚¿ãƒŸãƒŠæ•° (ã‚³ã‚¹ãƒˆ 21)</label>
        <input type="number" id="availableStamina" value="420" placeholder="ã‚¹ã‚¿ãƒŸãƒŠæ•°">

        <button onclick="calculateOptimal()">è¨ˆç®—å®Ÿè¡Œ</button>

        <div id="result">
            </div>
    </div>

    <script>
        function calculateOptimal() {
            const currentItems = parseInt(document.getElementById('currentItems').value);
            const availableStamina = parseInt(document.getElementById('availableStamina').value);

            if (isNaN(currentItems) || isNaN(availableStamina) || currentItems < 0 || availableStamina < 0) {
                document.getElementById('result').innerHTML = '<span style="color: red; font-weight: bold;">âš ï¸ ã‚¢ã‚¤ãƒ†ãƒ æ•°ã¨ã‚¹ã‚¿ãƒŸãƒŠæ•°ã«æ­£ã—ã„æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</span>';
                return;
            }

            const goal = 2000;
            const neededItems = goal - currentItems;
            let resultHtml = '';

            if (neededItems <= 0) {
                resultHtml = `<div class="status-header" style="color: green;">ğŸ‰ ç›®æ¨™ã‚¢ã‚¤ãƒ†ãƒ æ•°(${goal}å€‹)ã¯æ—¢ã«é”æˆã—ã¦ã„ã¾ã™ï¼</div>`;
                document.getElementById('result').innerHTML = resultHtml;
                return;
            }

            const STAMINA_COST = 21;
            const DROP_A = 10;
            const DROP_B = 3;
            const DROP_DIFF = DROP_A - DROP_B; // 7

            // ä½¿ãˆã‚‹ã‚¹ã‚¿ãƒŸãƒŠå†…ã§å¯èƒ½ãªæœ€å¤§ç·å›æ•° (T)
            const totalMaxCount = Math.floor(availableStamina / STAMINA_COST);

            // --- é¶´äº€ç®—ãƒ­ã‚¸ãƒƒã‚¯: Aã®æœ€å°å›æ•°ã‚’è¨ˆç®— (2000å€‹é”æˆã‚’ä¿è¨¼) ---
            
            // 1. å…¨å›æ•°(T)ã‚’åŠ¹ç‡ã®æ‚ªã„Bã§ã‚„ã£ãŸã¨ä»®å®šã—ãŸå ´åˆã®ã‚¢ã‚¤ãƒ†ãƒ æ•°
            const maxItemsFromB = totalMaxCount * DROP_B;
            
            // 2. ãã‚Œã§ã‚‚ç›®æ¨™ã«è¶³ã‚Šãªã„ã‚¢ã‚¤ãƒ†ãƒ æ•°
            const itemsShortage = neededItems - maxItemsFromB; 
            
            let finalMinACount;

            if (itemsShortage <= 0) {
                // ã™ã¹ã¦Bã§ã‚‚ç›®æ¨™é”æˆå¯èƒ½ï¼ˆAã¯0å›ã§OKï¼‰
                finalMinACount = 0;
            } else {
                // ä¸è¶³åˆ†ã‚’Aã¨Bã®ãƒ‰ãƒ­ãƒƒãƒ—å·®(7)ã§åŸ‹ã‚ã‚‹ãŸã‚ã«å¿…è¦ãªAã®å›æ•°
                finalMinACount = Math.ceil(itemsShortage / DROP_DIFF);
            }
            
            // 3. çµ„ã¿åˆã‚ã›ã®è¨ˆç®—
            const finalMaxBCount = totalMaxCount - finalMinACount;
            const totalItemsAchieved = (finalMinACount * DROP_A) + (finalMaxBCount * DROP_B);
            
            
            // --- 4. æœ€çµ‚åˆ¤å®š ---

            // Aã®æœ€å°å›æ•°ãŒã€ãã‚‚ãã‚‚ä½¿ãˆã‚‹å›æ•°(T)ã‚’è¶…ãˆã¦ã„ãŸã‚‰ã‚¹ã‚¿ãƒŸãƒŠä¸è¶³
            if (finalMinACount < 0 || finalMinACount > totalMaxCount) {
                // ã“ã®ãƒ­ã‚¸ãƒƒã‚¯ã§ã¯ finalMinACount ãŒ totalMaxCount ã‚’è¶…ãˆã‚‹å ´åˆã«ã‚¹ã‚¿ãƒŸãƒŠä¸è¶³ã¨ãªã‚‹
                
                // ã‚¹ã‚¿ãƒŸãƒŠä¸è¶³ã®å ´åˆã€ç›®æ¨™é”æˆã«å¿…è¦ãªæœ€å°ã‚¹ã‚¿ãƒŸãƒŠã‚’æ”¹ã‚ã¦è¨ˆç®—ã—ã¦è¡¨ç¤º
                const A_needed_for_2000_alone = Math.ceil(neededItems / DROP_A);
                const minStaminaCost_for_2000 = A_needed_for_2000_alone * STAMINA_COST;
                const shortage = minStaminaCost_for_2000 - availableStamina;
                
                resultHtml = `
                <div class="status-header" style="color: red;">âŒ ã‚¹ã‚¿ãƒŸãƒŠä¸è¶³ã§ç›®æ¨™é”æˆä¸å¯</div>
                ç›®æ¨™é”æˆã«å¿…è¦ãªæœ€å°ã‚¹ã‚¿ãƒŸãƒŠã¯ ${minStaminaCost_for_2000} ã§ã™ã€‚<br>
                ã‚ã¨ <strong>${shortage}</strong> ã‚¹ã‚¿ãƒŸãƒŠãŒå¿…è¦ã§ã™ã€‚
                `;
                
            } else if (totalItemsAchieved < neededItems) {
                 // ã‚¹ã‚¿ãƒŸãƒŠå†…ã§é ‘å¼µã£ã¦ã‚‚2000å€‹ã«å±Šã‹ãªã„å ´åˆ (ã‚¹ã‚¿ãƒŸãƒŠãŒåœ§å€’çš„ã«å°‘ãªã„)
                 const A_needed_for_2000_alone = Math.ceil(neededItems / DROP_A);
                 const minStaminaCost_for_2000 = A_needed_for_2000_alone * STAMINA_COST;
                 const shortage = minStaminaCost_for_2000 - availableStamina;
                 
                 resultHtml = `
                 <div class="status-header" style="color: red;">âŒ ã‚¹ã‚¿ãƒŸãƒŠä¸è¶³ã§ç›®æ¨™é”æˆä¸å¯</div>
                 ã‚¹ã‚¿ãƒŸãƒŠã‚’å…¨ã¦ä½¿ã£ã¦ã‚‚ç›®æ¨™ã®2000å€‹ã«å±Šãã¾ã›ã‚“ (æœ€å¤§ ${totalItemsAchieved}å€‹)ã€‚<br>
                 ã‚ã¨ <strong>${shortage}</strong> ã‚¹ã‚¿ãƒŸãƒŠãŒå¿…è¦ã§ã™ã€‚
                 `;

            } else {
                // é”æˆå¯èƒ½
                const minStaminaCost = totalMaxCount * STAMINA_COST; // ä½¿ãˆã‚‹ã‚¹ã‚¿ãƒŸãƒŠã®ç¯„å›²å†…ã§å›æ•°Tã‚’ä½¿ã„åˆ‡ã‚‹
                const remainingStamina = availableStamina - minStaminaCost;

                resultHtml = `
                <div class="status-header" style="color: green;">âœ… ç›®æ¨™é”æˆå¯èƒ½ï¼ˆAã®æœ€å°å›æ•°ï¼‰</div>

                <span class="min-count-line">2000å€‹é”æˆã®ãŸã‚ã«ã€Aã‚®ãƒ£ã‚¶ãƒ¼ã¯æœ€ä½ <strong>${finalMinACount}å›</strong> å‚åŠ ãŒå¿…è¦ã§ã™ã€‚</span>

                <span class="details-header">
                ğŸ”¸ å†…è¨³ï¼ˆä½¿ãˆã‚‹ã‚¹ã‚¿ãƒŸãƒŠ ${availableStamina} ã®ç¯„å›²ã§æœ€ã‚‚AãŒå°‘ãªã„çµ„ã¿åˆã‚ã›ï¼‰:
                </span>
                <ul>
                    <li>ãƒ»Aã‚®ãƒ£ã‚¶ãƒ¼ (ãƒ‰ãƒ­ãƒƒãƒ—10): ${finalMinACount}å›</li>
                    <li>ãƒ»Bã‚®ãƒ£ã‚¶ãƒ¼ (ãƒ‰ãƒ­ãƒƒãƒ—3): ${finalMaxBCount}å›</li>
                    <li>ãƒ»åˆè¨ˆã‚¢ã‚¤ãƒ†ãƒ : ${totalItemsAchieved}å€‹</li>
                    <li>ãƒ»åˆè¨ˆæ¶ˆè²»ã‚¹ã‚¿ãƒŸãƒŠ: ${minStaminaCost} (æ®‹ã‚Šã‚¹ã‚¿ãƒŸãƒŠ: ${remainingStamina})</li>
                </ul>
                `;
            }

            document.getElementById('result').innerHTML = resultHtml;
        }

        document.addEventListener('DOMContentLoaded', calculateOptimal);
        document.getElementById('currentItems').addEventListener('input', calculateOptimal);
        document.getElementById('availableStamina').addEventListener('input', calculateOptimal);

    </script>
</body>
</html>
