<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚²ãƒ¼ãƒ ã‚®ãƒ£ã‚¶ãƒ¼æœ€é©åŒ–è¨ˆç®—ãƒ„ãƒ¼ãƒ«</title>
    
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            max-width: 500px; /* ã‚¹ãƒãƒ›ã§è¦‹ã‚„ã™ã„æœ€å¤§å¹… */
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f4f9;
            color: #333;
        }

        h1 {
            text-align: center;
            color: #1a73e8;
            font-size: 1.8rem;
            margin-bottom: 30px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            font-size: 1rem;
        }

        input[type="number"] {
            width: 100%;
            padding: 12px;
            font-size: 1.2rem;
            border: 2px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
        }

        button {
            width: 100%;
            padding: 15px;
            font-size: 1.3rem;
            font-weight: bold;
            color: white;
            background-color: #4285f4;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 10px;
            transition: background-color 0.2s;
        }

        button:hover {
            background-color: #357ae8;
        }

        /* ä¿®æ­£ç‚¹: çµæœãƒœãƒƒã‚¯ã‚¹ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å®‰å®šåŒ– */
        .result-box {
            margin-top: 30px;
            padding: 10px 15px;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            white-space: pre-wrap;
            min-height: 100px;
            font-size: 1.1rem;
            line-height: 1.4; /* è¡Œé–“ã‚’è©°ã‚ã‚‹ */
            text-align: left; /* å·¦å¯„ã›è¨­å®šã‚’å¼·åˆ¶ */
        }
        
        .status-header {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .min-count-line {
            display: block;
            margin: 10px 0;
            font-size: 1.1rem;
            font-weight: normal;
        }
        
        /* é»„è‰²ã„å†…è¨³ãƒ˜ãƒƒãƒ€ãƒ¼ã®å·¦å¯„ã›ã¨ç¸¦é•·ã‚’è§£æ¶ˆ */
        .details-header {
            display: block; /* ãƒ–ãƒ­ãƒƒã‚¯è¦ç´ ã«ã—ã¦å·¦ç«¯ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆ */
            margin-top: 10px; 
            font-weight: bold; 
            color: orange;
            margin-bottom: 5px; /* ä¸‹ã®ä½™ç™½ã‚’å‰Šæ¸› */
        }

        /* ä¿®æ­£ç‚¹: ãƒªã‚¹ãƒˆã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’å¾¹åº•çš„ã«ãƒªã‚»ãƒƒãƒˆ */
        .result-box ul {
            list-style: none;
            padding-left: 0 !important; /* ãƒªã‚»ãƒƒãƒˆã‚’å¼·åˆ¶ */
            margin: 5px 0 0 !important; /* ãƒãƒ¼ã‚¸ãƒ³ã‚’å‰Šæ¸› */
            border-top: 1px dashed #ccc;
            padding-top: 10px;
        }
        
        /* ãƒªã‚¹ãƒˆé …ç›®ã‚‚å·¦å¯„ã› */
        .result-box li {
            margin-bottom: 3px; /* ãƒªã‚¹ãƒˆé …ç›®ã®ç¸¦é•·ã‚’å‰Šæ¸› */
            padding-left: 0 !important; /* å·¦å¯„ã›ã‚’å¼·åˆ¶ */
        }
    </style>
</head>
<body>
    <h1>ã‚¢ã‚¤ãƒ†ãƒ ç›®æ¨™é”æˆè¨ˆç®—</h1>
    <div class="input-group">
        <label for="currentItems">ç¾åœ¨ã®ã‚¢ã‚¤ãƒ†ãƒ å€‹æ•° (ç›®æ¨™ 2000)</label>
        <input type="number" id="currentItems" value="1000" placeholder="ç¾åœ¨ã®å€‹æ•°">
    </div>
    <div class="input-group">
        <label for="availableStamina">ä½¿ãˆã‚‹ã‚¹ã‚¿ãƒŸãƒŠæ•° (ã‚³ã‚¹ãƒˆ 21)</label>
        <input type="number" id="availableStamina" value="420" placeholder="ã‚¹ã‚¿ãƒŸãƒŠæ•°">
    </div>

    <button onclick="calculateOptimal()">è¨ˆç®—å®Ÿè¡Œ</button>

    <div id="result" class="result-box">
        </div>

    <script>
        function calculateOptimal() {
            const currentItems = parseInt(document.getElementById('currentItems').value);
            const availableStamina = parseInt(document.getElementById('availableStamina').value);

            if (isNaN(currentItems) || isNaN(availableStamina) || currentItems < 0 || availableStamina < 0) {
                document.getElementById('result').innerHTML = '<span style="color: red; font-weight: bold;">âš ï¸ ã‚¢ã‚¤ãƒ†ãƒ æ•°ã¨ã‚¹ã‚¿ãƒŸãƒŠæ•°ã«æ­£ã—ã„æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</span>';
                return;
            }

            const goal = 2000;
            const neededItems = goal - currentItems;
            let resultHtml = '';

            if (neededItems <= 0) {
                resultHtml = `<div class="status-header" style="color: green;">ğŸ‰ ç›®æ¨™ã‚¢ã‚¤ãƒ†ãƒ æ•°(${goal}å€‹)ã¯æ—¢ã«é”æˆã—ã¦ã„ã¾ã™ï¼</div>`;
                document.getElementById('result').innerHTML = resultHtml;
                return;
            }

            const STAMINA_COST = 21;
            const DROP_A = 10;
            const DROP_B = 3;

            // --- 1. ç›®æ¨™é”æˆã«å¿…è¦ãªæœ€å°ç·å›æ•°ã‚’è¨ˆç®— (Bã‚’æœ€å¤§é™æ´»ç”¨) ---
            
            let minTotalCount = Infinity;
            let finalMinACount = -1;
            let finalMinBCount = -1;
            
            // Aã®å›æ•°ã¯ 0 ã‹ã‚‰ã€ã™ã¹ã¦Aã§é”æˆã§ãã‚‹æœ€å¤§å›æ•°ã¾ã§è©¦ã™
            const A_max_needed = Math.ceil(neededItems / DROP_A); 

            for (let a = 0; a <= A_max_needed; a++) {
                const remainingItems = neededItems - (a * DROP_A);
                // Bã§è£œã†å›æ•°ã‚’è¨ˆç®— (åˆ‡ã‚Šä¸Šã’)
                const b = remainingItems <= 0 ? 0 : Math.ceil(remainingItems / DROP_B);
                
                const totalCount = a + b;
                
                if (totalCount < minTotalCount) {
                    minTotalCount = totalCount;
                    finalMinACount = a;
                    finalMinBCount = b;
                }
            }

            const minStaminaCost = minTotalCount * STAMINA_COST;
            const totalItemsAchieved = (finalMinACount * DROP_A) + (finalMinBCount * DROP_B);
            
            // --- 2. ã‚¹ã‚¿ãƒŸãƒŠåˆ¶ç´„ã®åˆ¤å®š ---

            if (minStaminaCost > availableStamina) {
                // ã‚¹ã‚¿ãƒŸãƒŠä¸è¶³
                const shortage = minStaminaCost - availableStamina;
                
                // ã‚¹ã‚¿ãƒŸãƒŠä¸è¶³ã®å ´åˆã‚‚ã€ç›®æ¨™é”æˆã«å¿…è¦ãªæœ€å°å›æ•°ã‚’è¡¨ç¤º
                resultHtml = `
                <div class="status-header" style="color: red;">âŒ ã‚¹ã‚¿ãƒŸãƒŠä¸è¶³ã§ç›®æ¨™é”æˆä¸å¯</div>
                ç›®æ¨™é”æˆã«å¿…è¦ãªæœ€å°å›æ•° ${minTotalCount}å›åˆ†ã®ã‚¹ã‚¿ãƒŸãƒŠã¯ ${minStaminaCost} ã§ã™ã€‚
                <br>
                ã‚ã¨ <strong>${shortage}</strong> ã‚¹ã‚¿ãƒŸãƒŠãŒå¿…è¦ã§ã™ã€‚
                `;
            } else {
                // é”æˆå¯èƒ½
                const remainingStamina = availableStamina - minStaminaCost;

                resultHtml = `
                <div class="status-header" style="color: green;">âœ… ç›®æ¨™é”æˆå¯èƒ½ï¼ˆæœ€å°å›æ•°ï¼‰</div>

                <span class="min-count-line">2000å€‹é”æˆã®ãŸã‚ã«ã€Aã‚®ãƒ£ã‚¶ãƒ¼ã¯æœ€ä½ <strong>${finalMinACount}å›</strong> å‚åŠ ãŒå¿…è¦ã§ã™ã€‚</span>

                <span class="details-header">
                ğŸ”¸ å†…è¨³ï¼ˆæœ€å°ã‚¹ã‚¿ãƒŸãƒŠ ${minStaminaCost} ã§é”æˆï¼‰:
                </span>
                <ul>
                    <li>ãƒ»Aã‚®ãƒ£ã‚¶ãƒ¼ (ãƒ‰ãƒ­ãƒƒãƒ—10): ${finalMinACount}å›</li>
                    <li>ãƒ»Bã‚®ãƒ£ã‚¶ãƒ¼ (ãƒ‰ãƒ­ãƒƒãƒ—3): ${finalMinBCount}å›</li>
                    <li>ãƒ»åˆè¨ˆã‚¢ã‚¤ãƒ†ãƒ : ${totalItemsAchieved}å€‹</li>
                    <li>ãƒ»åˆè¨ˆæ¶ˆè²»ã‚¹ã‚¿ãƒŸãƒŠ: ${minStaminaCost} (æ®‹ã‚Šã‚¹ã‚¿ãƒŸãƒŠ: ${remainingStamina})</li>
                </ul>
                `;
            }

            document.getElementById('result').innerHTML = resultHtml;
        }

        document.addEventListener('DOMContentLoaded', calculateOptimal);
        document.getElementById('currentItems').addEventListener('input', calculateOptimal);
        document.getElementById('availableStamina').addEventListener('input', calculateOptimal);

    </script>
</body>
</html>
