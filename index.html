<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Âè¨Âñö„Ç§„Éô</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f0f0f0;
      padding: 2em;
      margin: 0;
    }

    h1 {
      text-align: center;
      color: #333;
      font-size: 1.5em;
    }

    form {
      background: #fff;
      padding: 1em;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      max-width: 600px;
      margin: auto;
      width: 100%;
      box-sizing: border-box;
    }

    label {
      display: block;
      margin: 0.5em 0;
      font-size: 1em;
    }

    input {
      width: 100%;
      padding: 0.5em;
      margin-top: 0.2em;
      box-sizing: border-box;
      font-size: 1em;
    }

    button {
      margin-top: 1em;
      padding: 0.7em 1.5em;
      font-size: 1em;
      background-color: #0078d4;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      width: 100%;
    }

    button:hover {
      background-color: #005fa3;
    }

    pre {
      margin-top: 2em;
      background: #fff;
      padding: 1em;
      border-radius: 8px;
      white-space: pre-wrap;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
      max-width: 600px;
      margin: 2em auto 0;
      box-sizing: border-box;
      font-size: 0.95em;
    }

    @media (max-width: 480px) {
      body {
        padding: 1em;
      }

      h1 {
        font-size: 1.2em;
      }

      label, input, button, pre {
        font-size: 1em;
      }
    }
  </style>
</head>
<body>
  <h1>„Éç„Ç∫„ÉüÂè¨Âñö</h1>
  <form>
    <label for="currentItems">ÁèæÂú®„ÅÆ„Ç¢„Ç§„ÉÜ„É†ÂÄãÊï∞ (ÁõÆÊ®ô 2000)</label>
    <input type="number" id="currentItems" placeholder="ÁèæÂú®„ÅÆÂÄãÊï∞">

    <label for="availableStamina">‰Ωø„Åà„Çã„Çπ„Çø„Éü„ÉäÊï∞ („Ç≥„Çπ„Éà 21)</label>
    <input type="number" id="availableStamina" placeholder="„Çπ„Çø„Éü„ÉäÊï∞">

    <button type="button" onclick="calculateOptimal()">Ë®àÁÆóÂÆüË°å</button>
  </form>

  <pre id="result"></pre>

  <script>
    function calculateOptimal() {
      const currentItems = parseInt(document.getElementById('currentItems').value);
      const availableStamina = parseInt(document.getElementById('availableStamina').value);

      if (isNaN(currentItems) || isNaN(availableStamina) || currentItems < 0 || availableStamina < 0) {
        document.getElementById('result').textContent = '‚ö†Ô∏è „Ç¢„Ç§„ÉÜ„É†Êï∞„Å®„Çπ„Çø„Éü„ÉäÊï∞„Å´Ê≠£„Åó„ÅÑÊï∞ÂÄ§„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ';
        return;
      }

      const goal = 2000;
      const neededItems = goal - currentItems;
      let resultText = '';

      if (neededItems <= 0) {
        resultText = `üéâ ÁõÆÊ®ô„Ç¢„Ç§„ÉÜ„É†Êï∞(${goal}ÂÄã)„ÅØÊó¢„Å´ÈÅîÊàê„Åó„Å¶„ÅÑ„Åæ„ÅôÔºÅ`;
        document.getElementById('result').textContent = resultText;
        return;
      }

      const STAMINA_COST = 21;
      const DROP_A = 10;
      const DROP_B = 3;
      const DROP_DIFF = DROP_A - DROP_B;

      const totalMaxCount = Math.floor(availableStamina / STAMINA_COST);
      const maxItemsFromB = totalMaxCount * DROP_B;
      const itemsShortage = neededItems - maxItemsFromB;

      let finalMinACount;

      if (itemsShortage <= 0) {
        finalMinACount = 0;
      } else {
        finalMinACount = Math.ceil(itemsShortage / DROP_DIFF);
      }

      const finalMaxBCount = totalMaxCount - finalMinACount;
      const totalItemsAchieved = (finalMinACount * DROP_A) + (finalMaxBCount * DROP_B);

      if (finalMinACount < 0 || finalMinACount > totalMaxCount || totalItemsAchieved < neededItems) {
        const A_needed_for_2000_alone = Math.ceil(neededItems / DROP_A);
        const minStaminaCost_for_2000 = A_needed_for_2000_alone * STAMINA_COST;
        const shortage = minStaminaCost_for_2000 - availableStamina;

        resultText = `‚ùå „Çπ„Çø„Éü„Éä‰∏çË∂≥„ÅßÁõÆÊ®ôÈÅîÊàê‰∏çÂèØ\nÁõÆÊ®ôÈÅîÊàê„Å´ÂøÖË¶Å„Å™ÊúÄÂ∞è„Çπ„Çø„Éü„Éä„ÅØ ${minStaminaCost_for_2000} „Åß„Åô„ÄÇ\n„ÅÇ„Å® ${shortage} „Çπ„Çø„Éü„Éä„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ`;
      } else {
        const minStaminaCost = totalMaxCount * STAMINA_COST;
        const remainingStamina = availableStamina - minStaminaCost;

        resultText = `‚úÖ ÁõÆÊ®ôÈÅîÊàêÂèØËÉΩÔºàA„ÅÆÊúÄÂ∞èÂõûÊï∞Ôºâ\n\n2000ÂÄãÈÅîÊàê„ÅÆ„Åü„ÇÅ„Å´„ÄÅA„ÇÆ„É£„Ç∂„Éº„ÅØÊúÄ‰Ωé ${finalMinACount}Âõû ÂèÇÂä†„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ\n\nüî∏ ÂÜÖË®≥Ôºà‰Ωø„Åà„Çã„Çπ„Çø„Éü„Éä ${availableStamina} „ÅÆÁØÑÂõ≤„ÅßÊúÄ„ÇÇA„ÅåÂ∞ë„Å™„ÅÑÁµÑ„ÅøÂêà„Çè„ÅõÔºâ:\n„ÉªA„ÇÆ„É£„Ç∂„Éº („Éâ„É≠„ÉÉ„Éó10): ${finalMinACount}Âõû\n„ÉªB„ÇÆ„É£„Ç∂„Éº („Éâ„É≠„ÉÉ„Éó3): ${finalMaxBCount}Âõû\n„ÉªÂêàË®à„Ç¢„Ç§„ÉÜ„É†: ${totalItemsAchieved}ÂÄã\n„ÉªÂêàË®àÊ∂àË≤ª„Çπ„Çø„Éü„Éä: ${minStaminaCost} (ÊÆã„Çä„Çπ„Çø„Éü„Éä: ${remainingStamina})`;
      }

      document.getElementById('result').textContent = resultText;
    }

    window.onload = calculateOptimal;
    document.getElementById('currentItems').addEventListener('input', calculateOptimal);
    document.getElementById('availableStamina').addEventListener('input', calculateOptimal);
  </script>
</body>
</html>
